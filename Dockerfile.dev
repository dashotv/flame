FROM golang:1.18-alpine

RUN apk add --no-cache --update curl \
    bash \
    grep \
    sed \
    jq \
    ca-certificates \
    openssl \
    git \
	make \
	gcc \
	musl-dev

WORKDIR /app

COPY go.* .
RUN go mod tidy

COPY . .

RUN make deps

EXPOSE 9001
EXPOSE 3001

CMD ["gin","--appPort", "9001", "--port", "3001", "--immediate", "run", "server"]
